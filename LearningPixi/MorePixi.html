<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Somos Pixies, somos pixies</title>
</head>
  <script src="pixi.min.js"></script>
<body>
  <script>
    var Container = PIXI.Container;
    var stage = new Container(),
        renderer = PIXI.autoDetectRenderer(512,512),
        loader = PIXI.loader,
        resources = PIXI.loader.resources,
        Sprite = PIXI.Sprite;

    document.body.appendChild(renderer.view);


    var TextureCache = PIXI.utils.TextureCache;
    var texture = TextureCache["images/forroman1.jpg"];
    var sprite = new PIXI.Sprite(texture);

    loader
      //.add("images/forroman1.jpg")
      .add("images/treasureHunter.json")
      .load(setupAtlas);

    //Esta funcion setup() corre cuando la imagen haya cargado

    function setupAtlas(){
      var dungeon, explorer, treasure, blob;
      //Creamos una variable que referencie todo el atlas
      var atlas = PIXI.loader.resources["images/treasureHunter.json"].textures;

      dungeon = new Sprite(atlas["dungeon.png"]);
      stage.addChild(dungeon);

      treasure = new Sprite(atlas["treasure.png"]);
      treasure.x = stage.width - treasure.width - 48;
      treasure.y = stage.height / 2 - treasure.height / 2;
      stage.addChild(treasure);

      explorer = new Sprite(atlas["explorer.png"]);
      explorer.x = 68;
      explorer.y = stage.height / 2 - explorer.height / 2;
      stage.addChild(explorer);

      door = new Sprite(atlas["door.png"]);
      door.position.set(32,0);
      stage.addChild(door);

      //Para crear varios blobs y ubicarlos random
      var numberOfBlobs = 6,
          spacing = 48,
          xOffSet = 150;

      for (var i = 0; i < numberOfBlobs; i++) {
        var blob = new Sprite(atlas["blob.png"]);

        //Space each blob horizontally according to the `spacing` value.
        //`xOffset` determines the point from the left of the screen
        //at which the first blob should be added.
        var x = spacing * i + xOffSet;

        //Le damos al blob una posicion Y random con la funcion randomInt()
        //El 64 es para que no choque con el borde de arriba ni de abajo
        var y = randomInt(64, stage.height - 64);

        //Le asignamos esas posiciones y lo agregamos al stage
        blob.x = x;
        blob.y = y;
        stage.addChild(blob);
      }

      renderer.render(stage);

    }

    function randomInt(min,max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    function setupTileSet(){
      var texture = TextureCache["images/tileset.png"];

      //Creamos un rectangulo
      var Rectangle = PIXI.Rectangle;
      var rectangle = new Rectangle(96,64,32,32);
      //Le decimos al texture que use esa sección rectangular
      texture.frame = rectangle;
      //Creamos el sprite
      var rocket = new Sprite(texture);
      rocket.x = 300;
      rocket.y = 300;
      rocket.height = 200;
      rocket.width = 200;
      stage.addChild(rocket);
      renderer.render(stage);
    }

    function setupForroman(){
      //Creamos el sprite
      var forroman = new Sprite(
        resources["images/forroman1.jpg"].texture
      );

      forroman.position.set(300,300);
      forroman.height = 300;
      forroman.width = 200;

      //Cambio el ancla del sprite al centro de ésta
      forroman.anchor.x = 0.5;
      forroman.anchor.y = 0.5;

      //Lo roto
      forroman.rotation = 0.5;


      //Lo agregamos al stage
      stage.addChild(forroman);
      //Le decimos al renderer que renderice el stage
      renderer.render(stage);
    }

  </script>
</body>
</html>
